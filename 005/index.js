/*QUIK_ADDON 1|从HTML导入书签工具|1|1.0.0|从HTML导入书签工具，点击右上角主菜单导入|siquan|https://api.tfseek.top/public/resources/q-913b04c5.png|https://siquan001.github.io/|version.txt|siquan.importformhtml */
quik.mainmenu.pushMenu({icon:util.getGoogleIcon("ea18"),title:"导入书签",click:function(){e.open()}});var e=new quik.dialog({content:"<h1>导入书签</h1><div class='content'><p>上传包含书签数据的HTML文件</p><br><input type='file'/></div><div class='footer'><div class='btn ok'>确定</div><div class='btn cancel'>取消</div></div>",class:"syncfdia"}),t=e.getDialogDom(),i=util.query(t,"input");util.query(t,".btn.ok").onclick=function(){if(i.files[0]){e.close();var t=new FileReader;t.readAsText(i.files[0]),t.onload=function(){!function(e){var t=util.element("iframe",{src:"about:blank"});document.body.append(t),t.contentDocument.write(e);var i=t.contentDocument.querySelector("dl");if(!i)return void quik.toast.show("解析失败");function n(e){for(var t=e.childNodes,i={},o=0;o<t.length;o++)if("DT"==t[o].tagName){var r=t[o].querySelector("h3");if(r)i[r.innerText]=n(t[o].querySelector("dl"));else{var a=t[o].querySelector("a");i[a.innerText]=a.href}}return i}var o=n(i),r=util.deepClone(o["书签栏"]);if(r)for(var a in delete o["书签栏"],r)o[a]=r[a];var l=[],s={};for(var a in o)if("string"!=typeof o[a]||o[a].startsWith("javascript:")){if("object"==typeof o[a]){var c=[];function u(e){for(var t in e)"string"!=typeof e[t]||e[t].startsWith("javascript:")?"object"==typeof e[t]&&u(e[t]):c.push({title:t,url:e[t]})}u(o[a]),s[a]=c}}else l.push({title:a,url:o[a]});var f={link:{title:"链接",desc:"QUIK起始页链接数据",data:{linksize:quik.link.getLinkSize(),links:l,cate:s}}};quik.sync.setJSON(f,{link:"compare"})}(t.result)},t.onerror=function(){quik.toast.show("解析失败")},quik.toast.show("正在解析")}else quik.toast.show("请先上传文件")};